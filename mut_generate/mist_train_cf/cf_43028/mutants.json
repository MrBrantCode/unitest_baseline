{
  "task_id": "cf_43028",
  "entry_point": "create_emr_cluster_script",
  "mutant_count": 19,
  "mutants": [
    {
      "operator": "ASR",
      "lineno": 3,
      "original_line": "script += f\"--name {JOB_NAME} \\\\\\n\"",
      "mutated_line": "script -= f'--name {JOB_NAME} \\\\\\n'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script -= f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "ASR",
      "lineno": 4,
      "original_line": "script += f\"--execution-role-arn {EMR_ROLE_ARN} \\\\\\n\"",
      "mutated_line": "script -= f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script -= f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "ASR",
      "lineno": 5,
      "original_line": "script += f\"--release-label {EMR_RELEASE_LABEL} \\\\\\n\"",
      "mutated_line": "script -= f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script -= f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "ASR",
      "lineno": 6,
      "original_line": "script += '--job-driver \\'{\"sparkSubmitJobDriver\": {' \\",
      "mutated_line": "script -= f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script -= f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "ASR",
      "lineno": 10,
      "original_line": "script += '--configuration-overrides \\'{\"monitoringConfiguration\": {' \\",
      "mutated_line": "script -= f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script -= f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 2,
      "original_line": "script = f\"--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n\"",
      "mutated_line": "script = f'{VIRTUAL_CLUSTER_ID} \\\\\\n'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'{VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 2,
      "original_line": "script = f\"--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n\"",
      "mutated_line": "script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID}'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID}'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 3,
      "original_line": "script += f\"--name {JOB_NAME} \\\\\\n\"",
      "mutated_line": "script += f'{JOB_NAME} \\\\\\n'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'{JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 3,
      "original_line": "script += f\"--name {JOB_NAME} \\\\\\n\"",
      "mutated_line": "script += f'--name {JOB_NAME}'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME}'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 4,
      "original_line": "script += f\"--execution-role-arn {EMR_ROLE_ARN} \\\\\\n\"",
      "mutated_line": "script += f'{EMR_ROLE_ARN} \\\\\\n'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'{EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 4,
      "original_line": "script += f\"--execution-role-arn {EMR_ROLE_ARN} \\\\\\n\"",
      "mutated_line": "script += f'--execution-role-arn {EMR_ROLE_ARN}'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN}'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 5,
      "original_line": "script += f\"--release-label {EMR_RELEASE_LABEL} \\\\\\n\"",
      "mutated_line": "script += f'{EMR_RELEASE_LABEL} \\\\\\n'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'{EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 5,
      "original_line": "script += f\"--release-label {EMR_RELEASE_LABEL} \\\\\\n\"",
      "mutated_line": "script += f'--release-label {EMR_RELEASE_LABEL}'",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL}'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 6,
      "original_line": "script += '--job-driver \\'{\"sparkSubmitJobDriver\": {' \\",
      "mutated_line": "script += f'''{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 6,
      "original_line": "script += '--job-driver \\'{\"sparkSubmitJobDriver\": {' \\",
      "mutated_line": "script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 6,
      "original_line": "script += '--job-driver \\'{\"sparkSubmitJobDriver\": {' \\",
      "mutated_line": "script += f\"\"\"--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n\"\"\"",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f\"\"\"--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n\"\"\"\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 6,
      "original_line": "script += '--job-driver \\'{\"sparkSubmitJobDriver\": {' \\",
      "mutated_line": "script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}'''",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 10,
      "original_line": "script += '--configuration-overrides \\'{\"monitoringConfiguration\": {' \\",
      "mutated_line": "script += f\"\"\"{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"{S3_BUCKET}/elasticmapreduce/emr-containers\"}}}}'\"\"\"\n    return script"
    },
    {
      "operator": "CRP",
      "lineno": 10,
      "original_line": "script += '--configuration-overrides \\'{\"monitoringConfiguration\": {' \\",
      "mutated_line": "script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}\"\"\"",
      "code": "def create_emr_cluster_script(VIRTUAL_CLUSTER_ID, JOB_NAME, EMR_ROLE_ARN, S3_BUCKET, EMR_RELEASE_LABEL, EMR_MASTER_DNS_NAME):\n    script = f'--virtual-cluster-id {VIRTUAL_CLUSTER_ID} \\\\\\n'\n    script += f'--name {JOB_NAME} \\\\\\n'\n    script += f'--execution-role-arn {EMR_ROLE_ARN} \\\\\\n'\n    script += f'--release-label {EMR_RELEASE_LABEL} \\\\\\n'\n    script += f'''--job-driver '{{\"sparkSubmitJobDriver\": {{\"entryPoint\": \"s3://{S3_BUCKET}/app_code/job/hivethrift_emr.py\",\"entryPointArguments\":[\"s3://{S3_BUCKET}\",\"{EMR_MASTER_DNS_NAME}\"],\"sparkSubmitParameters\": \"--conf spark.driver.cores=1 --conf spark.executor.memory=4G --conf spark.driver.memory=1G --conf spark.executor.cores=2\"}}}}' \\\\\\n'''\n    script += f\"\"\"--configuration-overrides '{{\"monitoringConfiguration\": {{\"s3MonitoringConfiguration\": {{\"logUri\": \"s3://{S3_BUCKET}\"\"\"\n    return script"
    }
  ]
}