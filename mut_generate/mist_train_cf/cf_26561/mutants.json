{
  "task_id": "cf_26561",
  "entry_point": "calculate_metrics",
  "mutant_count": 29,
  "mutants": [
    {
      "operator": "CRP",
      "lineno": 8,
      "original_line": "Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]",
      "mutated_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[1]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 8,
      "original_line": "Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]",
      "mutated_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[-1]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 8,
      "original_line": "Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]",
      "mutated_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[1]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 14,
      "original_line": "GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]",
      "mutated_line": "GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[1]",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[1]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 14,
      "original_line": "GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]",
      "mutated_line": "GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[-1]",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[-1]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 14,
      "original_line": "GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]",
      "mutated_line": "GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[1]",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[1]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 26,
      "original_line": "'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(),",
      "mutated_line": "metrics = {'': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 27,
      "original_line": "'Pred_Pos': Pred_Pos,",
      "mutated_line": "metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), '': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), '': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 28,
      "original_line": "'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(),",
      "mutated_line": "metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, '': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, '': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 29,
      "original_line": "'GS_Pos': GS_Pos,",
      "mutated_line": "metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), '': GS_Pos, 'TP_per_cc': TP_per_cc}",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), '': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 30,
      "original_line": "'TP_per_cc': TP_per_cc",
      "mutated_line": "metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, '': TP_per_cc}",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, '': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 5,
      "original_line": "Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby(\"clinical_case\")[\"code\"].count()",
      "mutated_line": "Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')[''].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')[''].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 11,
      "original_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby(\"clinical_case\")[\"code\"].count()",
      "mutated_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')[''].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')[''].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 5,
      "original_line": "Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby(\"clinical_case\")[\"code\"].count()",
      "mutated_line": "Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 11,
      "original_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby(\"clinical_case\")[\"code\"].count()",
      "mutated_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 8,
      "original_line": "Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]",
      "mutated_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 8,
      "original_line": "Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]",
      "mutated_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', '']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 14,
      "original_line": "GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]",
      "mutated_line": "GS_Pos = df_gs.drop_duplicates(subset=['', 'code']).shape[0]",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 14,
      "original_line": "GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]",
      "mutated_line": "GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', '']).shape[0]",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', '']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "ROR",
      "lineno": 20,
      "original_line": "pred = set(df_pred.loc[df_pred['clinical_case']==c,'code'].values)",
      "mutated_line": "pred = set(df_pred.loc[df_pred['clinical_case'] != c, 'code'].values)",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] != c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 20,
      "original_line": "pred = set(df_pred.loc[df_pred['clinical_case']==c,'code'].values)",
      "mutated_line": "pred = set(df_pred.loc[df_pred['clinical_case'] == c, ''].values)",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, ''].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "ROR",
      "lineno": 21,
      "original_line": "gs = set(df_gs.loc[df_gs['clinical_case']==c,'code'].values)",
      "mutated_line": "gs = set(df_gs.loc[df_gs['clinical_case'] != c, 'code'].values)",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] != c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 21,
      "original_line": "gs = set(df_gs.loc[df_gs['clinical_case']==c,'code'].values)",
      "mutated_line": "gs = set(df_gs.loc[df_gs['clinical_case'] == c, ''].values)",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, ''].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 20,
      "original_line": "pred = set(df_pred.loc[df_pred['clinical_case']==c,'code'].values)",
      "mutated_line": "pred = set(df_pred.loc[df_pred[''] == c, 'code'].values)",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred[''] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 21,
      "original_line": "gs = set(df_gs.loc[df_gs['clinical_case']==c,'code'].values)",
      "mutated_line": "gs = set(df_gs.loc[df_gs[''] == c, 'code'].values)",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs[''] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 5,
      "original_line": "Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby(\"clinical_case\")[\"code\"].count()",
      "mutated_line": "Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['', 'code']).groupby('clinical_case')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 5,
      "original_line": "Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby(\"clinical_case\")[\"code\"].count()",
      "mutated_line": "Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', '']).groupby('clinical_case')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', '']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 11,
      "original_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby(\"clinical_case\")[\"code\"].count()",
      "mutated_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['', 'code']).groupby('clinical_case')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['', 'code']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    },
    {
      "operator": "CRP",
      "lineno": 11,
      "original_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', 'code']).groupby(\"clinical_case\")[\"code\"].count()",
      "mutated_line": "GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', '']).groupby('clinical_case')['code'].count()",
      "code": "import pandas as pd\n\ndef calculate_metrics(df_gs, df_pred):\n    Pred_Pos_per_cc = df_pred.drop_duplicates(subset=['clinical_case', 'code']).groupby('clinical_case')['code'].count()\n    Pred_Pos = df_pred.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    GS_Pos_per_cc = df_gs.drop_duplicates(subset=['clinical_case', '']).groupby('clinical_case')['code'].count()\n    GS_Pos = df_gs.drop_duplicates(subset=['clinical_case', 'code']).shape[0]\n    cc = set(df_gs.clinical_case.tolist())\n    TP_per_cc = {}\n    for c in cc:\n        pred = set(df_pred.loc[df_pred['clinical_case'] == c, 'code'].values)\n        gs = set(df_gs.loc[df_gs['clinical_case'] == c, 'code'].values)\n        TP_per_cc[c] = len(pred.intersection(gs))\n    metrics = {'Pred_Pos_per_cc': Pred_Pos_per_cc.to_dict(), 'Pred_Pos': Pred_Pos, 'GS_Pos_per_cc': GS_Pos_per_cc.to_dict(), 'GS_Pos': GS_Pos, 'TP_per_cc': TP_per_cc}\n    return metrics"
    }
  ]
}